args=[]
sources=[
    {
        format=AVRO
        id="raw_family_relationship"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/observation/family-relationship"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_family_relationship"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/observation/family-relationship"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name="family_relationship"
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_vital_status"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/observation/vital-status"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_vital_status"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/observation/vital-status"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name="vital_status"
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_disease"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/condition/disease"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_disease"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/condition/disease"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=disease
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_phenotype"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/condition/phenotype"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_phenotype"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/condition/phenotype"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=phenotype
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_patient"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/patient"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_patient"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/patient"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=patient
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_group"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/group"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_group"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/group"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=group
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_drs_document_reference"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/documentreference/drs-document-reference"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_drs_document_reference"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/documentreference/drs-document-reference"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name="drs_document_reference"
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_researchstudy"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/researchstudy"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_researchstudy"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/researchstudy"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=researchstudy
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_researchsubject"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/researchsubject"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_researchsubject"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/researchsubject"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=researchsubject
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_specimen"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/specimen"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_specimen"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/specimen"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=specimen
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_organization"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "release_id"
        ]
        path="/fhir/organization"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_organization"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "release_id"
        ]
        path="/normalized/organization"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=organization
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=AVRO
        id="raw_task"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/fhir/task"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=DELTA
        id="normalized_task"
        keys=[]
        loadtype=OverWritePartition
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/normalized/task"
        readoptions {}
        storageid=storage
        table {
            database=normalized
            name=task
        }
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=JSON
        id="hpo_terms"
        keys=[]
        loadtype=OverWrite
        partitionby=[]
        path="/hpo_terms"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=JSON
        id="mondo_terms"
        keys=[]
        loadtype=OverWrite
        partitionby=[]
        path="/mondo_terms"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=PARQUET
        id="simple_participant"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/es_index/fhir/simple_participant"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=PARQUET
        id="es_index_study_centric"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/es_index/fhir/study_centric"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=PARQUET
        id="es_index_participant_centric"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/es_index/fhir/participant_centric"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=PARQUET
        id="es_index_file_centric"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/es_index/fhir/file_centric"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    },
    {
        format=PARQUET
        id="es_index_biospecimen_centric"
        keys=[]
        loadtype=OverWrite
        partitionby=[
            "study_id",
            "release_id"
        ]
        path="/es_index/fhir/biospecimen_centric"
        readoptions {}
        storageid=storage
        writeoptions {
            "created_on_column"="created_on"
            "updated_on_column"="updated_on"
            "valid_from_column"="valid_from"
            "valid_to_column"="valid_to"
        }
    }
]
sparkconf {
    "spark.databricks.delta.retentionDurationCheck.enabled"="false"
    "spark.delta.merge.repartitionBeforeWrite"="true"
    "spark.hadoop.fs.s3a.access.key"=${?AWS_ACCESS_KEY}
    "spark.hadoop.fs.s3a.endpoint"=${?AWS_ENDPOINT}
    "spark.hadoop.fs.s3a.impl"="org.apache.hadoop.fs.s3a.S3AFileSystem"
    "spark.hadoop.fs.s3a.path.style.access"="true"
    "spark.hadoop.fs.s3a.secret.key"=${?AWS_SECRET_KEY}
    "spark.master"=local
    "spark.sql.catalog.spark_catalog"="org.apache.spark.sql.delta.catalog.DeltaCatalog"
    "spark.sql.extensions"="io.delta.sql.DeltaSparkSessionExtension"
    "spark.sql.legacy.timeParserPolicy"=CORRECTED
    "spark.sql.mapKeyDedupPolicy"="LAST_WIN"
}
storages=[
    {
        filesystem=S3
        id=storage
        path="s3a://storage"
    }
]
